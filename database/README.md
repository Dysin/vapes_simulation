## 💨 **口感反馈表（Flavor_Feedback）结构设计**

### 一、表结构概览

| 字段名                | 类型      | 含义              | 说明                        |
| ------------------ | ------- | --------------- | ------------------------- |
| feedback_id        | VARCHAR | 反馈记录唯一ID        | 主键                        |
| design_id          | VARCHAR | 气道设计ID          | 外键，关联气道设计表                |
| simulation_id      | VARCHAR | 仿真ID            | 可选，用于关联CFD结果              |
| user_id            | VARCHAR | 用户唯一编号          | 若为盲测则可匿名                  |
| test_environment   | VARCHAR | 测试环境            | 例如 “25°C, 60% RH, 101kPa” |
| puff_volume        | FLOAT   | 抽吸体积 (mL)       | 如 55 mL                   |
| puff_duration      | FLOAT   | 抽吸时长 (s)        | 如 3.0 s                   |
| puff_flow_rate     | FLOAT   | 平均流量 (mL/s)     | 如 18.3 mL/s               |
| mouthfeel_score    | FLOAT   | 喉感/击喉感强度 (1–5)  | 感觉烟雾撞击喉咙的程度               |
| smoothness_score   | FLOAT   | 顺滑度 (1–5)       | 是否顺滑或干涩                   |
| warmth_score       | FLOAT   | 烟雾温热感 (1–5)     | 入口温度的主观感受                 |
| moisture_score     | FLOAT   | 湿润度 (1–5)       | 烟雾水汽感                     |
| aroma_intensity    | FLOAT   | 香气强度 (1–5)      | 入口香味强度                    |
| aroma_retention    | FLOAT   | 持香时间 (s)        | 香味残留时长                    |
| flavor_richness    | FLOAT   | 味层丰富度 (1–5)     | 是否多层次、有厚度                 |
| irritation_level   | FLOAT   | 刺激感 (1–5)       | 过强刺激则为高分                  |
| draw_resistance    | FLOAT   | 吸阻感 (Pa 或主观1–5) | 与压降/流量可对应                 |
| vapor_density      | FLOAT   | 烟雾浓度感 (1–5)     | 主观判断的浓度感                  |
| overall_score      | FLOAT   | 综合口感评分 (1–10)   | 综合评价指标                    |
| comment            | TEXT    | 用户描述            | 可包含“入口浓烈但略干”等自然语言反馈       |
| test_date          | DATE    | 测试日期            | 记录时间                      |
| device_temperature | FLOAT   | 烟具壳体温度 (°C)     | 环境或热感补充                   |
| coil_type          | VARCHAR | 发热丝类型           | 例如 FeCrAl、Ni80、Mesh 等     |

---

### 二、维度解释与物理关联建议

| 感官维度                    | 对应CFD/物理指标       | 备注               |
| ----------------------- | ---------------- | ---------------- |
| **吸阻（Draw Resistance）** | 入口出口压降 ΔP、气道流速分布 | 可定量对应，ΔP 大则吸阻强   |
| **喉感（Throat Hit）**      | 流速峰值、气体温度梯度、颗粒动量 | 高频局部冲击或温升导致刺激感   |
| **顺滑度（Smoothness）**     | 湍流强度 RMS、压力脉动    | 湍流剧烈、回流区多则口感“粗糙” |
| **烟雾浓度（Vapor Density）** | 平均流速 × 雾化效率      | 可间接由速度场和蒸汽生成区判断  |
| **温热感（Warmth）**         | 出口温度、温度梯度        | 温度过高会导致干口感       |
| **湿润感（Moisture）**       | 饱和蒸汽分数、相对湿度      | 与液体雾化量及冷凝有关      |
| **香气强度 / 层次**           | 流场均匀性、雾滴分布       | 均匀气流使香气分布更均一     |
| **刺激感（Irritation）**     | 瞬时速度波动、局部高温      | 过高的剪切速率或温度       |
| **综合口感评分（Overall）**     | 模型回归输出或平均值       | 用于训练回归模型预测主观口感   |

---

### 三、数据填充与结构化策略

为了让反馈数据能支撑分析与机器学习，建议采用两层结构：

#### 1. **定量字段**：数值化（方便统计）

如 `mouthfeel_score=4.2`、`draw_resistance=2.8`。

#### 2. **自然语言字段**：自由描述（用于NLP分析）

如 `comment="入口饱满，略有干涩，烟雾温度较高"`。

你可以后期使用 **文本情感分析（sentiment analysis）** 将主观描述自动量化为评分补充字段，例如：

* “浓郁”“顺滑” → +1
* “干”“呛” → -1

---

### 四、可视化与分析建议

可以建立视图（View）或报表，方便分析口感与流动参数的关系：

| 分析方向           | 示例图表    | 说明              |
| -------------- | ------- | --------------- |
| 吸阻 vs 压降       | 散点图/回归线 | 检查主观吸阻与CFD压降一致性 |
| 顺滑度 vs 湍流强度    | 热力图     | 湍流高 → 顺滑度低      |
| 烟雾浓度 vs 出口速度场  | 3D表面图   | 流量分布对烟雾浓度的影响    |
| 综合评分 vs 气道结构参数 | 平行坐标图   | 找出最优设计区间        |

---

### 五、数据示例

| feedback_id | design_id | puff_flow_rate | draw_resistance | warmth_score | smoothness_score | vapor_density | overall_score | comment              |
| ----------- | --------- | -------------- | --------------- | ------------ | ---------------- | ------------- | ------------- | -------------------- |
| fb_001      | design_01 | 18.0           | 3.2             | 4.5          | 4.8              | 4.7           | 9.2           | “入口顺滑，烟雾浓郁温热，击喉感适中。” |
| fb_002      | design_02 | 16.0           | 4.1             | 3.5          | 3.2              | 3.8           | 7.4           | “吸阻稍大，烟雾偏干，刺激感较强。”   |
| fb_003      | design_03 | 22.0           | 2.7             | 4.8          | 4.9              | 5.0           | 9.5           | “温度均匀，雾感丰富，体验极佳。”    |

---

### 六、后续拓展

后期可以在数据库中增加以下功能：

* **多用户一致性分析**（不同人对同设计的评分方差）
* **口感聚类分析**（用 PCA/K-means 找“顺滑型”“刺激型”等）
* **预测模型训练**（用 CFD + 几何参数 → 预测口感得分）

---